---
const { title, btnId, btnTitle, url } = Astro.props;
const base = import.meta.env.BASE_URL;
const bannerImage = `${base}/banner.png`.replace(/\/+/g, '/');

interface Props {
  title?: string;
  btnId: string;
  btnTitle: string;
  url: string;
}
---

<astro-banner btnId={btnId}>
  <div
    class="fixed bottom-0 start-1/2 z-50 w-full -translate-x-1/2 transform p-2 sm:max-w-2xl sm:p-4 lg:max-w-4xl"
    role="region"
    aria-label="Informational Banner"
  >
    <div
      class="mx-auto rounded-xl backdrop-blur-xl border border-white/20 px-3 py-2.5 text-center shadow-lg sm:rounded-2xl sm:px-6 sm:py-3.5 lg:rounded-3xl lg:px-10 lg:py-4 relative overflow-hidden"
      style={`box-shadow: 0 8px 32px rgba(58, 115, 193, 0.15); background-image: url('${bannerImage}'); background-size: cover; background-position: center; background-repeat: no-repeat;`}
    >
      <div class="relative flex items-center justify-center gap-2 sm:gap-4 lg:gap-5">
        <div class="flex flex-1 flex-col items-center gap-2 sm:flex-row sm:justify-center sm:gap-4 lg:gap-5">
          {title &&
          <p
            class="text-xs font-medium leading-tight sm:text-sm lg:text-base"
            style="color: white; text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5), 0 0 8px rgba(0, 0, 0, 0.3);"
          >
            {title}
          </p>
          }
          <a
            class="group inline-flex items-center gap-x-1.5 rounded-full bg-white/95 backdrop-blur-sm px-3.5 py-1.5 text-xs font-semibold text-[#3A73C1] transition-all duration-300 hover:bg-white hover:scale-[1.02] hover:shadow-md active:scale-[0.98] disabled:pointer-events-none disabled:opacity-50 sm:gap-x-2 sm:px-5 sm:py-2 sm:text-sm lg:px-7 lg:py-2.5 lg:text-base"
            href={url}
          >
            {btnTitle}
            <svg
              class="size-2.5 shrink-0 transition duration-300 group-hover:translate-x-0.5 sm:size-3.5 sm:group-hover:translate-x-1 lg:size-4"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2.5"
              stroke-linecap="round"
              stroke-linejoin="round"><path d="m9 18 6-6-6-6"></path></svg
            >
          </a>
        </div>
        <button
          type="button"
          class="flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-white/90 backdrop-blur-sm text-neutral-800 shadow-lg transition duration-300 hover:bg-white hover:scale-110 active:scale-95 disabled:pointer-events-none disabled:opacity-50 dark:bg-neutral-800/90 dark:text-neutral-200 sm:h-8 sm:w-8"
          id={btnId}
          aria-label="Fermer"
        >
          <span class="sr-only">Dismiss</span>
          <svg
            class="size-3.5 shrink-0 sm:size-4"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            ><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg
          >
        </button>
      </div>
    </div>
  </div>
</astro-banner>
<script>
  class AstroBanner extends HTMLElement {
    connectedCallback() {
      const btnId = this.getAttribute("btnId");
      const button = this.querySelector(`#${btnId}`);
      if (button != null) {
        button.addEventListener("click", () => this.remove());
      }
    }
  }

  customElements.define("astro-banner", AstroBanner);
</script>
