---
// Importing necessary components
import MainLayout from "@/layouts/MainLayout.astro";
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import CardSmall from "@components/ui/cards/CardSmall.astro";
import CardWide from "@components/ui/cards/CardWide.astro";
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import TestimonialsSectionAlt from "@components/sections/testimonials/TestimonialsSectionAlt.astro";

// Importing necessary functions from Astro
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";

// Fetching all the product related content and sorting it by main.id
const product: CollectionEntry<"products">[] = (
  await getCollection("products", ({ id }) => {
    return id.startsWith("fr/");
  })
).sort(
  (a: CollectionEntry<"products">, b: CollectionEntry<"products">) =>
    a.data.main.id - b.data.main.id
);

// Define variables for page content
const title: string = "Une App, Deux usages";
const subTitle: string =
  "Nutriwatt est une application unique qui s'adapte à votre usage. Que vous souhaitiez simplement suivre votre alimentation ou optimiser votre nutrition sportive avec Strava, l'app évolue avec vous.";

// Testimonial data that will be rendered in the component
const testimonials = [
  {
    content:
      " \"Nutriwatt Sport a complètement transformé ma façon d'aborder la nutrition et l'entraînement. L'intégration Strava est transparente et j'adore comment l'app ajuste automatiquement mes besoins en calories en fonction de mes entraînements. Enfin une app qui comprend les athlètes !\" ",
    author: "David Martinez",
    role: "Marathonien | Passionné de Fitness",
    avatarSrc:
      "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Image Description",
  },
  {
    content:
      " \"En tant que débutante dans le suivi nutritionnel, Nutriwatt était parfait pour moi. C'est simple, intuitif et ne me submerge pas avec des fonctionnalités dont je n'ai pas besoin. J'ai perdu 7 kilos en 3 mois et je comprends enfin ce que je mange !\" ",
    author: "Sophie Chen",
    role: "Débutante en Santé",
    avatarSrc:
      "https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Image Description",
  },
  {
    content:
      " \"La fonctionnalité de calcul automatique des nutriments est révolutionnaire. Je n'ai plus besoin de tout calculer manuellement, et l'app me dit exactement ce que je dois améliorer. Les recommandations sont parfaites et m'ont aidé à atteindre mes objectifs de fitness plus rapidement que je ne l'aurais jamais imaginé.\" ",
    author: "Thomas Johnson",
    role: "Coach Personnel | Coach Nutrition",
    avatarSrc:
      "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Image Description",
  },
];

const pageTitle = "Une App, Deux usages | Nutriwatt";
const metaDescription =
  "Nutriwatt est une application unique qui s'adapte à votre usage. Que vous souhaitiez simplement suivre votre alimentation ou optimiser votre nutrition sportive avec Strava, l'app évolue avec vous.";
const ogTitle = "Applications Santé & Nutrition | Nutriwatt";
---

<MainLayout
  title={pageTitle}
  lang="fr"
  customDescription={metaDescription}
  customOgTitle={ogTitle}
  structuredData={{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "@id": "https://raph13009.github.io/nutriwatt/fr/products",
    url: "https://raph13009.github.io/nutriwatt/fr/products",
    name: "Outils Matériels | ScrewFast",
    description:
      "Explorez la durabilité et la précision des outils ScrewFast, conçus aussi bien pour les professionnels que pour les passionnés.",
    isPartOf: {
      "@type": "WebSite",
      url: "https://raph13009.github.io/nutriwatt/fr",
      name: "ScrewFast",
      description:
        "ScrewFast propose des outils matériels de premier ordre et des services de construction experts pour répondre à tous vos besoins de projet.",
    },
    inLanguage: "fr",
  }}
>
  <div
    class="mx-auto max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 2xl:max-w-full"
  >
    <div class="mb-4 flex flex-col items-center gap-6 sm:mb-8 md:mb-12 md:flex-row md:justify-between md:gap-8">
      <div class="flex items-center gap-12">
        <h1
          class="text-2xl font-bold tracking-tight text-balance md:text-4xl md:leading-tight bg-gradient-to-r from-[#3A73C1] via-[#6FAFD6] to-[#7ECBC2] bg-clip-text text-transparent"
        >
          {title}
        </h1>
        {
          subTitle && (
            <p class="hidden max-w-(--breakpoint-sm) text-pretty text-neutral-600 md:block dark:text-neutral-400">
              {subTitle}
            </p>
          )
        }
      </div>
      <div class="flex w-full justify-center md:w-auto md:justify-end">
        <PrimaryCTA
          title="Ils utilisent Nutriwatt"
          url="#testimonials"
          noArrow={true}
        />
      </div>
    </div>
    {/* Displaying products in alternating styles. Alternative product gets different card styling. */}
    {/* Maps through all product entries and displays them with either CardSmall or CardWide based on their position. */}
    <section class="grid grid-cols-1 gap-4 sm:grid-cols-3 md:gap-6 xl:gap-8">
      {
        product.map((product, index) => {
          // Sport (id 1) gets CardWide, Normal (id 2) gets CardSmall
          if (product.data.main.id === 1) {
            return <CardWide product={product} productLocale="fr" />;
          } else {
            return <CardSmall product={product} productLocale="fr" />;
          }
        })
      }
    </section>
  </div>
  {/* Features statistics section */}
  <FeaturesStatsAlt
    title="Pourquoi Nutriwatt s'adapte à tous les profils"
    subTitle="Nutriwatt a été conçue pour accompagner aussi bien les utilisateurs souhaitant mieux manger que ceux cherchant à optimiser leur performance sportive."
    benefits={[
      "Suivi clair des calories et macronutriments, sans calcul manuel.",
      "Ajustement automatique des calories selon l'activité sportive (Strava & Garmin).",
      "Application gratuite, sans abonnement ni carte bancaire.",
    ]}
  />
  {/* Testimonials section */}
  <TestimonialsSectionAlt
    title="Ce que disent nos utilisateurs"
    testimonials={testimonials}
  />
</MainLayout>
