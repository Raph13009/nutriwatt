---
// Rediriger vers la version fran√ßaise
return Astro.redirect('/fr/products/', 301);
---
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import CardSmall from "@components/ui/cards/CardSmall.astro";
import CardWide from "@components/ui/cards/CardWide.astro";
import FeaturesStatsAlt from "@components/sections/features/FeaturesStatsAlt.astro";
import TestimonialsSectionAlt from "@components/sections/testimonials/TestimonialsSectionAlt.astro";

// Importing necessary functions from Astro
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";
import { SITE } from "@data/constants";

// Fetching all the product related content and sorting it by main.id
const product: CollectionEntry<"products">[] = (
  await getCollection("products", ({ id }) => {
    return id.startsWith("en/");
  })
).sort(
  (a: CollectionEntry<"products">, b: CollectionEntry<"products">) =>
    a.data.main.id - b.data.main.id
);

// Define variables for page content
const title: string = "Download Nutriwatt Apps";
const subTitle: string =
  "Download our free mobile apps for health and nutrition tracking. Choose Nutriwatt Sport for athletes with Strava integration, or Nutriwatt for everyday nutrition tracking. Both apps are completely free to download and use.";

// Testimonial data that will be rendered in the component
const testimonials = [
  // First testimonial data
  {
    content:
      " \"Nutriwatt Sport has completely transformed how I approach nutrition and training. The Strava integration is seamless, and I love how it automatically adjusts my calorie needs based on my workouts. Finally, an app that understands athletes!\" ",
    author: "Sarah Martinez",
    role: "Marathon Runner | Fitness Enthusiast",
    avatarSrc:
      "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=1374&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Image Description",
  },
  // Second testimonial data
  {
    content:
      " \"As someone new to tracking nutrition, Nutriwatt was perfect for me. It's simple, intuitive, and doesn't overwhelm me with features I don't need. I've lost 15 pounds in 3 months and finally understand what I'm eating!\" ",
    author: "Michael Chen",
    role: "Health Journey Beginner",
    avatarSrc:
      "https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1376&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D8&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Image Description",
  },
  // Third testimonial data
  {
    content:
      " \"The automatic nutrient calculation feature is a game-changer. I no longer have to manually calculate everything, and the app tells me exactly what I need to improve. The recommendations are spot-on and have helped me reach my fitness goals faster than I ever imagined.\" ",
    author: "Emily Johnson",
    role: "Personal Trainer | Nutrition Coach",
    avatarSrc:
      "https://images.unsplash.com/photo-1474176857210-7287d38d27c6?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D8&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80",
    avatarAlt: "Image Description",
  },
];

const pageTitle: string = `Our Apps | ${SITE.title}`;
const metaDescription =
  "Discover our mobile health and nutrition tracking apps designed to help you achieve your fitness goals.";
const ogTitle = "Health & Nutrition Apps | Nutriwatt";
---

<MainLayout
  title={pageTitle}
  customDescription={metaDescription}
  customOgTitle={ogTitle}
  structuredData={{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "@id": "https://screwfast.uk/products",
    url: "https://screwfast.uk/products",
    name: "Health & Nutrition Apps | Nutriwatt",
    description:
      "Discover our mobile health and nutrition tracking apps designed to help you achieve your fitness goals.",
    isPartOf: {
      "@type": "WebSite",
      url: "https://screwfast.uk",
      name: "Nutriwatt",
      description:
        "Nutriwatt offers mobile health and nutrition tracking apps to help you achieve your fitness and wellness goals.",
    },
    inLanguage: "en-US",
  }}
>
  <div
    class="mx-auto max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 2xl:max-w-full"
  >
    <div class="mb-4 flex items-center justify-between gap-8 sm:mb-8 md:mb-12">
      <div class="flex items-center gap-12">
        <h1
          class="text-2xl font-bold tracking-tight text-balance text-neutral-800 md:text-4xl md:leading-tight dark:text-neutral-200"
        >
          {title}
        </h1>
        {
          subTitle && (
            <p class="hidden max-w-(--breakpoint-sm) text-pretty text-neutral-600 md:block dark:text-neutral-400">
              {subTitle}
            </p>
          )
        }
      </div>
      <PrimaryCTA title="User Stories" url="#testimonials" noArrow={true} />
    </div>
    {/* Displaying products in alternating styles. Alternative product gets different card styling.
    Maps through all product entries and displays them with either CardSmall or CardWide based on their position. */}
    <section class="grid grid-cols-1 gap-4 sm:grid-cols-3 md:gap-6 xl:gap-8">
      {
        product.map((product, index) => {
          // Sport (id 1) gets CardWide, Normal (id 2) gets CardSmall
          if (product.data.main.id === 1) {
            return <CardWide product={product} />;
          } else {
            return <CardSmall product={product} />;
          }
        })
      }
    </section>
  </div>
  {/* Features statistics section */}
  <FeaturesStatsAlt
    title="Why Choose Nutriwatt?"
    subTitle="Transform your health goals into reality with Nutriwatt apps. Whether you're training for a marathon or just starting your wellness journey, our apps are designed to help you make better nutrition choices and achieve lasting results."
    benefits={[
      "Comprehensive nutrition tracking with automatic calculations.",
      "Seamless Strava integration for athletes and fitness enthusiasts.",
      "Personalized recommendations based on your goals and activity level.",
    ]}
  />
  {/* Testimonials section */}
  <TestimonialsSectionAlt
    title="What Our Customers Say"
    testimonials={testimonials}
  />
</MainLayout>
